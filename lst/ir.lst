C51 COMPILER V9.01   IR                                                                    03/20/2024 01:22:19 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE IR
OBJECT MODULE PLACED IN .\obj\ir.obj
COMPILER INVOKED BY: D:\MyProgrammeSetUp\KEILC51\C51\BIN\C51.EXE src\drive\ir.c LARGE BROWSE INCDIR(..\final_projects;.\
                    -src;.\src\app;.\src\drive;.\src\include) DEBUG OBJECTEXTEND PRINT(.\lst\ir.lst) OBJECT(.\obj\ir.obj)

line level    source

   1          #include"ir.h"
   2          
   3          unsigned char IrValue[6];
   4          static unsigned char Time;
   5          void IrInit(void){ 
   6   1      /*
   7   1      1.ܴҪжϵ
   8   1      2.ʼҪжϴ
   9   1      3.ߵĽնһ(ززߵ )ܵģ˽ʱͻ޷źʱΪ1
             -ŽΪ0 
  10   1      
  11   1      ⡿necЭԭͼ֪跢͵ʱ10msزߵƽ(1)40msزûУ0ʾ110msز
             -ߵƽ(1)20msز͵ƽ0ʾ0
  12   1      ôյʱͻȽյ10msزߵƽ10msûز40msزûл40msزߵƽ
             -˵10ms+40msûزʾʲô˼ɽն˵Ľ㷨ġ 
  13   1      */
  14   1      
  15   1              IT0 = 1;//Эͼ֪½شΪͶ˾ش½ش
  16   1              EX0 = 1;//ҵĺжǽp3.2ϵģƬ˿INT0ж0
  17   1              EA = 1;//ж
  18   1              
  19   1              IRIN = 1; //ʼ˿  
  20   1      }
  21          static void DelayMs(unsigned int x)   //135us
  22          {
  23   1              unsigned char i;
  24   1              while(x--)
  25   1              {
  26   2                      for (i = 0; i<13; i++)
  27   2                      {}
  28   2              }
  29   1      }
  30          
  31          void ReadIr() interrupt 0{        //init֮пжϴ򣬺ߵݽɵƬ
  32   1              
  33   1              unsigned char j = 0,k = 0;
  34   1              unsigned int err = 0;
  35   1              /*
  36   1              //Ϣжϴǲǿȷ
  37   1              uart_init();
  38   1              uart_send_byte(6); ȷʵԷȷĴϢ*/ 
  39   1              //IrValue[0] = 0xab;
  40   1              /*
  41   1              IrValue[1] = 0xab;
  42   1              IrValue[2] = 0xab;
  43   1              IrValue[3] = 0xab;        //жϵĻôȷʵԸı  */
  44   1              Time = 0;
  45   1              DelayMs(40);//նӦ9msĵ͵ƽȻһʱĸߵƽdebug֪ʱʵ4.8
             -msϵʱ䣩
  46   1              //IrValue[0] = 0x11;
  47   1              if(IRIN == 0){ //С9msʱ䣬ٿǲ0ȷǷĽյź
  48   2                      IrValue[3] = 0x22;      
  49   2                      err = 1000;
  50   2                      while((IRIN==0)&&(err>0)){ //С9msʱ󿴿IRINǲǻ00ô͸һʱȥȴ
C51 COMPILER V9.01   IR                                                                    03/20/2024 01:22:19 PAGE 2   

             -ȴʱ    136us*1000һֱ1ôerrʱƻԶ˳
  51   3                              DelayMs(1);//ִһδ136us
  52   3                              err--;//ʱơɵirin=1      
  53   3                      }
  54   2                      
  55   2                      if(IRIN == 1){  //Լ9msĵ͵ƽ ˸ߵƽ
  56   3                              //߼̫һֱwhileȥĵȴ4.5ms
  57   3                              err = 500;
  58   3                              while((IRIN == 1)&&(err > 0)){  //ÿÿ136usȥIRINǲ0500*136us      = 68msЭͼ
             -14.5msһʱwhile˳
  59   4                                      DelayMs(1);
  60   4                                      err--;
  61   4                              }  //while˳ʱʹ9ms4.5msˣʼźû
  62   3                              
  63   3                              for(k = 0; k < 4;++k){    //һ4ݣַַ롢
  64   4                                      for(j = 0;j < 8;++j){ //յ,ڷÿ10ʱ򶼻560us͵ƽ        
  65   5                                              err = 60;
  66   5                                              while((IRIN == 0)&&(err > 0)){    //Ĺȥ560usһΣȴ8ms
  67   6                                                      DelayMs(1);
  68   6                                                      err--;  
  69   6                                              }       
  70   5                                              
  71   5                                              err = 500;
  72   5                                              //濪ʼֵ10.Эͼ֪10ڸߵƽĳʱ䲻һ£11.69ms00.56ms
  73   5                                              while((IRIN ==1)&& (err > 0)){//ߵƽĳȣͨtimeǼжϵ10
  74   6                                                      DelayMs(1);
  75   6                                                      Time++;
  76   6                                                      err--;
  77   6                                                      if(Time > 30){ //ʱ
  78   7                                                              EX0 =1;
  79   7                                                              return; 
  80   7                                                      }
  81   6                                              }
  82   5      
  83   5                                                      IrValue[k]>>=1;//kʾǵڼ,һλӵλʼղҴ洢,Ȼÿλһ
             -
  84   5                                                      if(Time>=8){   //8*136us =      1ms1msʹ1
  85   6                                                              //IrValue[k] = 0xff;
  86   6                                                              IrValue[k] = IrValue[k]|0x80;//յ1ĻΪlsbͨ0x80(0b1000 0000)ʾյ1
             -IrValueҪִǰλһλ 
  87   6                                                      }
  88   5                                                      Time = 0;
  89   5                                              }//end ÿһλ   
  90   4                              } //end 
  91   3      
  92   3                              if(IrValue[2]==~IrValue[3]){//¼ֵͼֵɶԵ
  93   4                                      //uart_send_byte(0xff);
  94   4                                      IrValue[4] = IrValue[2];//ԭֵIrValue[4]
  95   4                                      //return ;
  96   4                              }  
  97   3                      }       //end IRIN  = 1;
  98   2              }//end IRIN = 0;
  99   1      }
 100          
 101          
 102          
 103          
 104          
 105          
 106          
 107          
 108          
C51 COMPILER V9.01   IR                                                                    03/20/2024 01:22:19 PAGE 3   

 109          
 110          
 111          
 112          
 113          
 114          
 115          
 116          
 117          
 118          
 119          
 120          
 121          
 122          
 123          
 124          
 125          
 126          
 127          
 128          
 129          
 130          
 131          
 132          
 133          
 134          
 135          
 136          
 137          
 138          
 139          
 140          
 141          
 142          
 143          
 144          
 145          
 146          
 147                                                                                                                                                                                                                                            


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    397    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      7       2
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
